<!doctype html>

<meta charset="utf-8">
<title>Dagre D3 User-defined Node Shapes Demo</title>

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="../build/dagre-d3.js"></script>
<style>

svg {
  border: 1px solid #999;
  overflow: hidden;
}

text {
  font-weight: 300;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 12px;
}

.node rect {
  stroke: #999;
  stroke-width: 1px;
  fill: #fff;
}

.edgeLabel rect {
  fill: #fff;
}

.edgePath path {
  stroke: #333;
  stroke-width: 1.5px;
  fill: none;
}
</style>

<body onLoad="draw();">

<svg x="0" y="0" width=269 height=391>
<g transform="translate(20,20)"/>

<defs>
	<g id="N0" width="30" height="30" transform="translate(-15,-15)"><polygon points="0,16.01017916333157 15.22658522033938,4.947417444457132 9.410547198766546,-12.952507026122916 -9.410547198766542,-12.952507026122918 -15.22658522033938,4.94741744445713 -3.921362932176701e-15,16.01017916333157 " transform="translate(15.726585388183594,13.452507019042969)" style="stroke: rgb(0, 0, 0); fill: rgb(255, 255, 0); stroke-width: 1px;"></polygon><text x="6.276585388183593" y="17.82555389404297" width="18.900000000000002" height="16.81640625" style="text-anchor: start; font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-style: normal; font-weight: 300; font-size: 14px; stroke: rgb(0, 0, 0); stroke-width: 1px; fill: rgb(0, 0, 0);">N0</text></g>
	<g id="N1" width="119" height="113" transform="translate(-59.5,-56.5)"><g transform="scale(0.5,0.5)"><polygon points="350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161" transform="translate(-229,-73)" style="stroke: rgb(0, 0, 0); fill-rule: evenodd; fill: rgb(0, 0, 255); stroke-width: 4px;"></polygon></g></g>
	<g id="N2" width="80" height="80" transform="translate(-40,-40)"><ellipse cx="40.5" cy="40.5" rx="40" ry="40" style="stroke: rgb(0, 0, 0); fill: rgb(173, 216, 230); stroke-width: 1px;"></ellipse><text x="31.049999999999997" y="44.873046875" width="18.900000000000002" height="16.81640625" style="text-anchor: start; font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-style: normal; font-weight: 300; font-size: 14px; stroke: rgb(0, 0, 0); stroke-width: 1px; fill: rgb(0, 0, 0);">N2</text></g>
</defs>

</svg>

<script>
function draw() {
  var g = new dagreD3.Digraph();
  g.addNode("N0", {label: "N0", use: "N0"});
  g.addNode("N1", {label: "N1", use: "N1"});
  g.addNode("N2", {label: "N2", use: "N2"});
  
  g.addEdge(null, "N0",     "N1",     { label: "N0-N1" });
  g.addEdge(null, "N1",     "N2",     { label: "N1-N2" });
  g.addEdge(null, "N2",     "N0",     { label: "N2-N0" });
  g.addEdge(null, "N0",     "N2",     { label: "N0-N2" });
  
  var renderer = new dagreD3.Renderer();
  var oldDrawNodes = renderer.drawNodes();
  renderer.drawNodes(function(graph, root) {
    var svgNodes = oldDrawNodes(graph, root);
    svgNodes.attr("id", function(u) { return "node-" + u; });
    return svgNodes;
  });
 
  
  renderer.run(g, d3.select("svg g"));
}
</script>
